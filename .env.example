# ============================================================
# Market!N Wix Integration - Environment Variables
# ============================================================
# Copy this file to .env and fill in your values
# For Render deployments, configure these in the Render dashboard
# ============================================================

# --------------------------
# Application Settings
# --------------------------

# Port to run the server on (Render sets this automatically)
PORT=3000

# Environment: development, staging, production
NODE_ENV=development

# Public URL of this app (REQUIRED for OAuth callbacks and webhooks)
# Examples:
#   Local: http://localhost:3000
#   ngrok: https://your-subdomain.ngrok-free.dev
#   Staging: https://marketin-wix-staging.onrender.com
#   Production: https://marketin-wix.onrender.com
APP_URL=https://your-app-domain.com

# Override tracking endpoint if different from APP_URL
# TRACKING_ENDPOINT=https://tracking.your-domain.com

# --------------------------
# Wix OAuth Credentials
# --------------------------
# Get these from Wix Developers Console:
# https://dev.wix.com/dc3/my-apps → Your App → OAuth

WIX_CLIENT_ID=your-wix-app-id
WIX_CLIENT_SECRET=your-wix-client-secret

# OAuth callback URL (must match what's configured in Wix Developer Center)
# Format: {APP_URL}/auth/callback
WIX_REDIRECT_URI=https://your-app-domain.com/auth/callback

# --------------------------
# Wix Webhook Verification
# --------------------------
# Wix uses RSA public key for webhook signatures (preferred method)
# Get your public key from Wix Developers Console → Webhooks
#
# Option 1 (Recommended): Base64-encode the PEM for single-line storage
#   macOS/Linux: cat public.pem | base64 | tr -d '\n'
#   WIX_PUBLIC_KEY=LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLQo...
#
# Option 2: Escape newlines with quotes
#   WIX_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkq...\n-----END PUBLIC KEY-----"
#
WIX_PUBLIC_KEY=

# Legacy HMAC secret (fallback if public key not configured)
WIX_WEBHOOK_SECRET=

# --------------------------
# Market!N API Configuration
# --------------------------
# Your Market!N platform API credentials

MARKETIN_API_KEY=your-marketin-api-key
MARKETIN_API_URL=https://api.marketin.now/api/v1
MARKETIN_BRAND_ID=

# --------------------------
# Database Configuration
# --------------------------
# For local development: SQLite
# For Render staging/production: PostgreSQL

# Database client: sqlite3 or pg
DB_CLIENT=sqlite3

# SQLite file path (local development only)
DB_FILENAME=./data/dev.sqlite

# PostgreSQL connection string (Render provides this)
# Format: postgres://user:password@host:port/database
# On Render, use the Internal Database URL for best performance
DATABASE_URL=

# Connection pool settings (for PostgreSQL)
DB_POOL_MIN=2
DB_POOL_MAX=10

# --------------------------
# Security
# --------------------------

# Token encryption key (32-byte hex string for AES-256-GCM)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
ENCRYPTION_KEY=

# Session secret for any session-based features
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
SESSION_SECRET=

# Admin API key for protected management endpoints
# Generate with: node -e "console.log(require('crypto').randomBytes(24).toString('hex'))"
ADMIN_API_KEY=

# --------------------------
# Visitor Session Settings
# --------------------------

# How long to retain visitor session data (days)
SESSION_TTL_DAYS=30

# --------------------------
# Queue Worker Settings
# --------------------------

# Poll interval for conversion queue (milliseconds)
QUEUE_POLL_INTERVAL=30000

# Number of conversions to process per batch
QUEUE_BATCH_SIZE=10

# Hour to send daily summary email (0-23, in server timezone)
DAILY_SUMMARY_HOUR=9

# Redis URL (optional, for BullMQ-based queue)
# REDIS_URL=redis://localhost:6379

# --------------------------
# Email Alerts (SMTP)
# --------------------------
# Configure SMTP for error alerts and daily summaries

SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASS=

# Email address to receive alerts
ALERT_EMAIL=your-email@example.com

# From address for alert emails
ALERT_FROM_EMAIL=alerts@marketin.io
